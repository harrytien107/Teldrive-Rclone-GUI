<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="x-ua-compatible" content="IE=edge" />
  <title>Teldrive Rclone GUI - Pro Max</title>
  <HTA:APPLICATION ID="oHTA" APPLICATIONNAME="TeldriveRclone" BORDER="thin" BORDERSTYLE="normal" CAPTION="yes"
    MAXIMIZEBUTTON="yes" MINIMIZEBUTTON="yes" SHOWINTASKBAR="yes" SINGLEINSTANCE="yes" SYSMENU="yes" VERSION="3.0"
    WINDOWSTATE="normal" SCROLL="no" INNERBORDER="no" SELECTION="no" CONTEXTMENU="yes" />
  <style>
    /* Absolute Positioning Layout V3 - Medium Size */
    * {
      box-sizing: border-box;
      user-select: none;
      cursor: default;
    }

    body {
      margin: 0;
      padding: 0;
      background-color: #0d1117;
      color: #c9d1d9;
      font-family: "Segoe UI", sans-serif;
      height: 100%;
      width: 100%;
      overflow: hidden;
      font-size: 15px;
    }

    /* Sidebar */
    .sidebar {
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      width: 240px;
      background-color: #161b22;
      border-right: 1px solid #30363d;
      padding: 1.2rem;
      overflow-y: auto;
      z-index: 10;
    }

    .brand {
      display: flex;
      align-items: center;
      margin-bottom: 2rem;
      padding-left: 0.2rem;
    }

    .brand img {
      width: 32px;
      height: 32px;
      margin-right: 10px;
    }

    .brand span {
      font-weight: 600;
      font-size: 1.3rem;
      color: #c9d1d9;
    }

    .brand-accent {
      color: #58a6ff;
    }

    .nav-item {
      display: block;
      padding: 10px 14px;
      margin-bottom: 6px;
      border-radius: 6px;
      color: #8b949e;
      cursor: pointer;
      font-weight: 500;
      font-size: 1rem;
    }

    .nav-item:hover {
      background-color: #21262d;
      color: #c9d1d9;
    }

    .nav-item.active {
      background-color: rgba(88, 166, 255, 0.15);
      color: #58a6ff;
    }

    .nav-item i {
      margin-right: 12px;
      width: 20px;
      text-align: center;
      display: inline-block;
    }

    .sidebar-footer {
      position: absolute;
      bottom: 1.5rem;
      left: 1.2rem;
      right: 1.2rem;
      border-top: 1px solid #30363d;
      padding-top: 1.2rem;
    }

    /* Main Content */
    .main-content {
      position: absolute;
      top: 0;
      left: 240px;
      right: 0;
      bottom: 0;
      background-color: #0d1117;
      overflow: hidden;
    }

    .header {
      height: 60px;
      width: 100%;
      border-bottom: 1px solid #30363d;
      display: block;
      padding: 0 2rem;
      line-height: 60px;
      background-color: #0d1117;
    }

    .page-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #c9d1d9;
    }

    .scroll-area {
      position: absolute;
      top: 60px;
      left: 0;
      right: 0;
      bottom: 0;
      overflow-y: auto;
      padding: 2rem;
    }

    .scroll-area::-webkit-scrollbar {
      width: 12px;
    }

    .scroll-area::-webkit-scrollbar-track {
      background: #0d1117;
    }

    .scroll-area::-webkit-scrollbar-thumb {
      background: #30363d;
      border-radius: 6px;
      border: 2px solid #0d1117;
    }

    /* Cards */
    .card {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      position: relative;
      display: block;
    }

    .card-header {
      height: 30px;
      margin-bottom: 1.2rem;
      position: relative;
    }

    .card-title {
      font-weight: 600;
      color: #c9d1d9;
      position: absolute;
      left: 0;
      top: 0;
      font-size: 1.1rem;
    }

    .status-badge {
      position: absolute;
      right: 0;
      top: 0;
      font-size: 0.85rem;
      padding: 4px 10px;
      border-radius: 14px;
      background: #21262d;
      color: #8b949e;
      font-weight: 500;
    }

    .status-badge.running {
      background: rgba(35, 134, 54, 0.15);
      color: #3fb950;
      border: 1px solid rgba(35, 134, 54, 0.4);
    }

    .status-badge.stopped {
      background: rgba(218, 54, 51, 0.15);
      color: #f85149;
      border: 1px solid rgba(218, 54, 51, 0.4);
    }

    /* Inputs & Layouts */
    .form-group {
      margin-bottom: 1.2rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      color: #8b949e;
      font-size: 0.9rem;
    }

    .grid-row {
      display: table;
      width: 100%;
      border-spacing: 8px 0;
      margin-left: -8px;
    }

    .grid-cell {
      display: table-cell;
      vertical-align: top;
    }

    .w-100 {
      width: 100%;
    }

    .w-auto {
      width: 1%;
      white-space: nowrap;
    }

    input[type="text"],
    input[type="password"] {
      width: 100%;
      height: 38px;
      background-color: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 0 12px;
      color: #c9d1d9;
      font-family: Consolas, monospace;
      outline: none;
      font-size: 1rem;
    }

    input[type="text"]:focus {
      border-color: #58a6ff;
    }

    button {
      height: 38px;
      padding: 0 16px;
      border-radius: 6px;
      border: 1px solid #30363d;
      background-color: #21262d;
      color: #c9d1d9;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.95rem;
      font-family: monospace;
    }

    button:hover {
      background-color: #30363d;
    }

    button.primary {
      background-color: #238636;
      color: white;
      border-color: rgba(255, 255, 255, 0.1);
    }

    button.primary:hover {
      background-color: #2ea043;
    }

    button.danger {
      color: #f85149;
    }

    button.sm {
      height: 30px;
      padding: 0 10px;
      font-size: 0.85rem;
    }

    /* Logs */
    .terminal {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 12px;
      font-family: Consolas, monospace;
      height: 300px;
      overflow-y: auto;
      color: #8b949e;
      font-size: 13px;
      white-space: pre-wrap;
    }

    .log-info {
      color: #58a6ff;
    }

    .log-success {
      color: #3fb950;
    }

    .log-error {
      color: #f85149;
    }

    .log-warn {
      color: #d29922;
    }

    /* Helper Helpers */
    .hidden {
      display: none !important;
    }

    .mt-2 {
      margin-top: 1rem;
    }
  </style>

  <script>
    window.onerror = function (msg, url, line) { alert("Error: " + msg + "\nLine: " + line); return false; };

    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var sh = new ActiveXObject("WScript.Shell");
    var gAppDir = "";
    var gWindowStatePath = "";

    function expand(str) { return sh.ExpandEnvironmentStrings(str); }
    function getWindowStatePath() {
      if (!gWindowStatePath) {
        var dir = expand("%APPDATA%") + "\\TeldriveRclone";
        if (!fso.FolderExists(dir)) fso.CreateFolder(dir);
        gWindowStatePath = dir + "\\window_state.json";
      }
      return gWindowStatePath;
    }

    function saveWindowState() {
      try {
        if (window.screenLeft <= -30000) return;
        var state = { left: window.screenLeft, top: window.screenTop, width: window.outerWidth, height: window.outerHeight };
        var ts = fso.OpenTextFile(getWindowStatePath(), 2, true);
        ts.Write(JSON.stringify(state)); ts.Close();
      } catch (e) { }
    }

    function restoreWindowState() {
      try {
        var path = getWindowStatePath();
        if (fso.FileExists(path)) {
          var ts = fso.OpenTextFile(path, 1, false);
          var state = JSON.parse(ts.ReadAll()); ts.Close();
          if (state) { window.resizeTo(state.width, state.height); window.moveTo(state.left, state.top); }
        }
      } catch (e) { }
    }

    function bootstrap() {
      restoreWindowState();
      window.setInterval(saveWindowState, 2000);

      try {
        var p = unescape(location.pathname);
        if (p.charAt(0) == '/') p = p.substring(1);
        gAppDir = fso.GetParentFolderName(p);
      } catch (e) { }


      switchTab('home');
      loadSettings();
      log("System Ready. V3.0", "success");
    }



    function switchTab(tabId) {
      document.getElementById('tab-home').className = tabId == 'home' ? '' : 'hidden';
      document.getElementById('tab-rclone').className = tabId == 'rclone' ? '' : 'hidden';
      document.getElementById('tab-config').className = tabId == 'config' ? '' : 'hidden';
      document.getElementById('tab-logs').className = tabId == 'logs' ? '' : 'hidden';

      document.getElementById('nav-home').className = tabId == 'home' ? 'nav-item active' : 'nav-item';
      document.getElementById('nav-rclone').className = tabId == 'rclone' ? 'nav-item active' : 'nav-item';
      document.getElementById('nav-config').className = tabId == 'config' ? 'nav-item active' : 'nav-item';
      document.getElementById('nav-logs').className = tabId == 'logs' ? 'nav-item active' : 'nav-item';

      document.getElementById('page-title').innerText = tabId.charAt(0).toUpperCase() + tabId.slice(1);
    }

    function log(msg, type) {
      if (!type) type = "info";
      var el = document.createElement('div');
      el.className = "log-entry log-" + type;
      el.innerText = "[" + new Date().toLocaleTimeString() + "] " + msg;
      var term = document.getElementById('terminal-output');
      if (term) { term.appendChild(el); term.scrollTop = term.scrollHeight; }
    }

    // --- Actions ---

    function browseFile(targetInputId) {
      setTimeout(function () { document.getElementById('hidden-file-input').click(); }, 10);
      var fileInput = document.getElementById('hidden-file-input');
      fileInput.onchange = function () {
        if (fileInput.value) {
          document.getElementById(targetInputId).value = fileInput.value;
          saveSettings();
          fileInput.value = "";
        }
      };
    }

    function startTeldrive() {
      var exe = document.getElementById('inp-teldrive-path').value;
      var conf = document.getElementById('inp-teldrive-conf').value;
      var port = document.getElementById('inp-teldrive-port').value;

      if (!fso.FileExists(exe)) { log("Teldrive executable not found!", "error"); return; }

      // Build arguments
      var cmdArgs = 'run';

      // Only add config if user provided one. 
      // Otherwise Teldrive uses default ~/.teldrive/config.toml
      if (conf && conf.trim() !== "") {
        cmdArgs += ' -c "' + conf + '"';
      }

      if (port && port.trim() !== "") {
        cmdArgs += ' --port ' + port;
      }

      var cmd = 'powershell -WindowStyle Hidden -Command "Start-Process -FilePath \'' + exe + '\' -ArgumentList \'' + cmdArgs + '\' -NoNewWindow"';

      try {
        sh.Run(cmd, 0, false);
        log("Starting Teldrive...", "info");
        updateStatus("teldrive-status", true);
      } catch (e) { log("Start Error: " + e.message, "error"); }
    }

    function stopTeldrive() {
      sh.Run('powershell -WindowStyle Hidden -Command "Stop-Process -Name teldrive -Force -ErrorAction SilentlyContinue"', 0, true);
      log("Stopped Teldrive.", "warn");
      updateStatus("teldrive-status", false);
    }

    function openTeldriveBrowser() {
      var port = document.getElementById('inp-teldrive-port').value || "8080";
      var url = "http://localhost:" + port;
      try { sh.Run(url); log("Opening " + url, "info"); } catch (e) { log(e.message, "error"); }
    }

    function runTeldriveCmd(arg) {
      var exe = document.getElementById('inp-teldrive-path').value;
      if (!fso.FileExists(exe)) return;
      var cmd = 'powershell -NoProfile -Command "& \'' + exe + '\' ' + arg + '"';
      // Run and capture output not easy in HTA without tmp file.
      // We will run visible for version/help or use a pipe wrapper.
      // Let's run in new window for Help.
      sh.Run('cmd /c "' + exe + '" ' + arg + ' & pause', 1, false);
    }

    function mountRclone() {
      var rclone = document.getElementById('inp-rclone-path').value;
      var conf = document.getElementById('inp-rclone-conf').value;
      var remote = document.getElementById('inp-remote').value;
      var mount = document.getElementById('inp-mount').value;
      var flags = document.getElementById('inp-rclone-flags').value; // Extra flags

      var args = 'mount ' + remote + ' ' + mount + ' --config ' + conf + ' --vfs-cache-mode full ' + flags;
      var cmd = 'powershell -WindowStyle Hidden -Command "Start-Process -FilePath \'' + rclone + '\' -ArgumentList \'' + args + '\' -NoNewWindow"';
      try { sh.Run(cmd, 0, false); log("Mount command sent.", "success"); updateStatus("mount-status", true); } catch (e) { log("Mount Error: " + e.message, "error"); }
    }

    function startWebDAV() {
      var rclone = document.getElementById('inp-rclone-path').value;
      var conf = document.getElementById('inp-rclone-conf').value;
      var remote = document.getElementById('inp-remote').value;
      var port = document.getElementById('inp-webdav-port').value || "8090";

      var args = 'serve webdav ' + remote + ' --addr :' + port + ' --config ' + conf + ' --vfs-cache-mode full';
      var cmd = 'powershell -WindowStyle Hidden -Command "Start-Process -FilePath \'' + rclone + '\' -ArgumentList \'' + args + '\' -NoNewWindow"';
      try {
        sh.Run(cmd, 0, false);
        log("WebDAV started on :" + port, "success");
        updateStatus("webdav-status", true);
      } catch (e) { log("WebDAV Error: " + e.message, "error"); }
    }

    function stopWebDAV() {
      var ps = "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'rclone.exe' -and $_.CommandLine -match 'serve webdav' } | Stop-Process -Force";
      var cmd = 'powershell -WindowStyle Hidden -Command "' + ps + '"';
      try {
        sh.Run(cmd, 0, true);
        log("Stopped WebDAV.", "warn");
        updateStatus("webdav-status", false);
      } catch (e) { log("Stop Error: " + e.message, "error"); }
    }

    function openWebDavBrowser() {
      var port = document.getElementById('inp-webdav-port').value || "8090";
      var url = "http://localhost:" + port;
      try { sh.Run(url); log("Opening " + url, "info"); } catch (e) { log(e.message, "error"); }
    }

    function runRcloneCopy() {
      var rclone = document.getElementById('inp-rclone-path').value;
      var conf = document.getElementById('inp-rclone-conf').value;

      var src = document.getElementById('inp-copy-src').value;
      var dst = document.getElementById('inp-copy-dst').value;
      var flags = document.getElementById('inp-copy-flags').value; // --update --ignore-existing ...

      // Use visible window for Copy to see progress
      var cmd = 'cmd /c ""' + rclone + '" copy "' + src + '" "' + dst + '" --config "' + conf + '" ' + flags + ' & pause"';
      sh.Run(cmd, 1, false);
      log("Started Copy Operation...", "info");
    }

    // Config Utils
    function listRemotes() {
      var rclone = document.getElementById('inp-rclone-path').value;
      var conf = document.getElementById('inp-rclone-conf').value;
      sh.Run('cmd /c ""' + rclone + '" listremotes --config "' + conf + '" & pause"', 1, false);
    }

    function editToken() {
      // Read file, find token, replace? Too risky.
      // User asked: "Edit Access token".
      // Let's prompt for new token and append/replace in a text area or just open config.
      // Opening config is safest.
      // But to satisfy "Chỉnh sửa Access token", let's offer a targeted replace.
      var token = prompt("Enter new Access Token (Paste here):");
      if (token && token.length > 10) {
        var path = document.getElementById('inp-rclone-conf').value;
        try {
          var f = fso.OpenTextFile(path, 1);
          var content = f.ReadAll();
          f.Close();

          // Regex replace `token = { ... }` ? Or just notify user.
          // JSON in INI is tricky. 
          log("Feature partial: Please paste token in the config file manually.", "warn");
          sh.Run('notepad "' + path + '"');
        } catch (e) { log(e.message, "error"); }
      }
    }

    function updateStatus(elId, isRunning) {
      var el = document.getElementById(elId);
      el.className = isRunning ? "status-badge running" : "status-badge stopped";
      el.innerText = isRunning ? "Running" : "Stopped";
    }

    function saveSettings() {
      var settings = {
        teldrive: document.getElementById('inp-teldrive-path').value,
        teldrive_conf: document.getElementById('inp-teldrive-conf').value,
        teldrive_port: document.getElementById('inp-teldrive-port').value,
        rclone: document.getElementById('inp-rclone-path').value,
        conf: document.getElementById('inp-rclone-conf').value,
        remote: document.getElementById('inp-remote').value,
        mount: document.getElementById('inp-mount').value,
        rclone_flags: document.getElementById('inp-rclone-flags').value,
        webdav_port: document.getElementById('inp-webdav-port').value,
        copy_src: document.getElementById('inp-copy-src').value,
        copy_dst: document.getElementById('inp-copy-dst').value,
        copy_flags: document.getElementById('inp-copy-flags').value
      };
      try { var f = fso.CreateTextFile(gAppDir + "\\settings.json", true); f.Write(JSON.stringify(settings)); f.Close(); } catch (e) { }
    }

    function loadSettings() {
      try {
        if (fso.FileExists(gAppDir + "\\settings.json")) {
          var f = fso.OpenTextFile(gAppDir + "\\settings.json", 1);
          var s = JSON.parse(f.ReadAll()); f.Close();

          if (s.teldrive) document.getElementById('inp-teldrive-path').value = s.teldrive;
          if (s.teldrive_conf) document.getElementById('inp-teldrive-conf').value = s.teldrive_conf;
          if (s.teldrive_port) document.getElementById('inp-teldrive-port').value = s.teldrive_port;

          if (s.rclone) document.getElementById('inp-rclone-path').value = s.rclone;
          if (s.conf) document.getElementById('inp-rclone-conf').value = s.conf;
          if (s.remote) document.getElementById('inp-remote').value = s.remote;
          if (s.mount) document.getElementById('inp-mount').value = s.mount;
          if (s.rclone_flags) document.getElementById('inp-rclone-flags').value = s.rclone_flags;

          if (s.webdav_port) document.getElementById('inp-webdav-port').value = s.webdav_port;

          if (s.copy_src) document.getElementById('inp-copy-src').value = s.copy_src;
          if (s.copy_dst) document.getElementById('inp-copy-dst').value = s.copy_dst;
          if (s.copy_flags) document.getElementById('inp-copy-flags').value = s.copy_flags;
        } else {
          // Defaults
          document.getElementById('inp-teldrive-conf').value = "C:\\Users\\Tien\\.teldrive\\config.toml";
          document.getElementById('inp-webdav-port').value = "8090";
          document.getElementById('inp-copy-flags').value = "--update --ignore-existing -v";
          document.getElementById('inp-copy-src').value = "pgs:/TheGdriveXbot";
          document.getElementById('inp-copy-dst').value = "teldrive:/TheGdriveXbot";
        }
      } catch (e) { }
    }

  </script>
</head>

<body onload="bootstrap()">

  <div class="sidebar">
    <div class="brand">
      <img src="https://teldrive-docs.pages.dev/images/logo.png" onerror="this.style.display='none'">
      <span>Teldrive<span class="brand-accent">GUI</span></span>
    </div>
    <div id="nav-home" class="nav-item active" onclick="switchTab('home')"><i>&#8962;</i> Teldrive</div>
    <div id="nav-rclone" class="nav-item" onclick="switchTab('rclone')"><i>&#128190;</i> Rclone</div>
    <div id="nav-config" class="nav-item" onclick="switchTab('config')"><i>&#9881;</i> Config</div>
    <div id="nav-logs" class="nav-item" onclick="switchTab('logs')"><i>&#8801;</i> Logs</div>

    <div class="sidebar-footer">
      <div class="nav-item" onclick="sh.Run('https://teldrive-docs.pages.dev')"><i>&#128366;</i> Tutorial</div>
      <div class="nav-item" onclick="sh.Run('https://github.com/harrytien107')"><i>?</i> Help</div>
      <div
        style="margin-top: 15px; font-size: 12px; color: #8b949e; text-align: center; border-top: 1px solid #30363d; padding-top: 10px;">
        <span style="color: #c9d1d9;">v3.0</span> <br>
        <span style="color: #58a6ff; font-weight: bold; cursor: pointer;"
          onclick="sh.Run('https://github.com/harrytien107')">harrytien107</span>
      </div>
    </div>
  </div>

  <div class="main-content">
    <div class="header">
      <div id="page-title" class="page-title">Home</div>
    </div>

    <div class="scroll-area">
      <input type="file" id="hidden-file-input" style="display:none" />

      <!-- TELDRIVE TAB -->
      <div id="tab-home">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Server Control</div>
            <div id="teldrive-status" class="status-badge stopped">Stopped</div>
          </div>
          <div class="form-group">
            <label class="form-label">Executable</label>
            <div class="grid-row">
              <div class="grid-cell w-100"><input type="text" id="inp-teldrive-path" placeholder="teldrive.exe"
                  onblur="saveSettings()"></div>
              <div class="grid-cell w-auto" style="padding-left:5px"><button
                  onclick="browseFile('inp-teldrive-path')">Browse</button></div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Config File (Optional)</label>
            <div class="grid-row">
              <div class="grid-cell w-100"><input type="text" id="inp-teldrive-conf"
                  placeholder="Default (~/.teldrive/config.toml)" onblur="saveSettings()"></div>
              <div class="grid-cell w-auto" style="padding-left:5px"><button
                  onclick="browseFile('inp-teldrive-conf')">Browse</button></div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Port (Optional)</label>
            <div class="grid-row">
              <div class="grid-cell"><input type="text" id="inp-teldrive-port" placeholder="Default" style="width:80px"
                  onblur="saveSettings()"></div>
            </div>
          </div>

          <div class="grid-row mt-2">
            <div class="grid-cell"><button class="primary" onclick="startTeldrive()">Start</button> <button
                class="danger" onclick="stopTeldrive()">Stop</button></div>
            <div class="grid-cell w-auto"><button onclick="openTeldriveBrowser()">Open Browser</button></div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Commands</div>
          </div>
          <button class="sm" onclick="runTeldriveCmd('version')">Check Version</button>
          <button class="sm" onclick="runTeldriveCmd('help')">Show Help</button>
          <button class="sm" onclick="runTeldriveCmd('check')">Check</button>
          <button class="sm" onclick="runTeldriveCmd('completion')">Completion</button>
          <button class="sm" onclick="runTeldriveCmd('upgrade')">Upgrade</button>
        </div>
      </div>

      <!-- RCLONE TAB -->
      <div id="tab-rclone" class="hidden">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Configuration</div>
          </div>
          <div class="form-group">
            <label class="form-label">Rclone Executable</label>
            <div class="grid-row">
              <div class="grid-cell w-100"><input type="text" id="inp-rclone-path" onblur="saveSettings()"></div>
              <div class="grid-cell w-auto" style="padding-left:5px"><button
                  onclick="browseFile('inp-rclone-path')">...</button></div>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Config File</label>
            <div class="grid-row">
              <div class="grid-cell w-100"><input type="text" id="inp-rclone-conf" onblur="saveSettings()"></div>
              <div class="grid-cell w-auto" style="padding-left:5px"><button
                  onclick="browseFile('inp-rclone-conf')">...</button></div>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Remote Name (with :)</label>
            <input type="text" id="inp-remote" onblur="saveSettings()">
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Mount</div>
            <div id="mount-status" class="status-badge stopped">Stopped</div>
          </div>
          <div class="grid-row">
            <div class="grid-cell w-100" style="padding-right:10px">
              <label class="form-label">Mount Point</label>
              <input type="text" id="inp-mount" value="Z:" onblur="saveSettings()">
            </div>
            <div class="grid-cell w-100">
              <label class="form-label">Extra Flags</label>
              <input type="text" id="inp-rclone-flags" placeholder="--vfs-cache-mode full" onblur="saveSettings()">
            </div>
          </div>
          <div class="mt-2">
            <button class="primary" onclick="mountRclone()">Mount</button> <button class="danger"
              onclick="stopMount()">Unmount</button>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">WebDAV Server</div>
            <div id="webdav-status" class="status-badge stopped">Stopped</div>
          </div>
          <div class="form-group">
            <label class="form-label">Listen Port</label>
            <input type="text" id="inp-webdav-port" value="8090" style="width:80px" onblur="saveSettings()">
          </div>
          <div class="mt-2">
            <button class="primary" onclick="startWebDAV()">Start</button>
            <button class="danger" onclick="stopWebDAV()">Stop</button>
            <button onclick="openWebDavBrowser()">Open Browser</button>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Copy Tool</div>
          </div>
          <div class="form-group">
            <label class="form-label">Source</label>
            <input type="text" id="inp-copy-src" value="pgs:/TheGdriveXbot" onblur="saveSettings()">
          </div>
          <div class="form-group">
            <label class="form-label">Destination</label>
            <input type="text" id="inp-copy-dst" value="teldrive:/TheGdriveXbot" onblur="saveSettings()">
          </div>
          <div class="form-group">
            <label class="form-label">Flags</label>
            <input type="text" id="inp-copy-flags" value="--update --ignore-existing -v" onblur="saveSettings()">
          </div>
          <button class="primary" onclick="runRcloneCopy()">Run Copy (CMD)</button>
        </div>
      </div>

      <!-- CONFIG TAB -->
      <div id="tab-config" class="hidden">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Manage Remotes</div>
          </div>
          <p style="color:#8b949e">Utilities for managing <code>rclone.conf</code>.</p>

          <div class="form-group">
            <button onclick="sh.Run('notepad ' + document.getElementById('inp-rclone-conf').value)">Edit Config File
              (Notepad)</button>
            <button onclick="editToken()">Edit Access Token (Manual)</button>
          </div>
          <div class="form-group">
            <button onclick="listRemotes()">List Remotes (CMD)</button>
            <button onclick="sh.Run('powershell -NoExit -Command rclone config')">Add/Edit Remote (Wizard)</button>
          </div>
        </div>
      </div>

      <!-- LOGS TAB -->
      <div id="tab-logs" class="hidden">
        <div class="card" style="padding:0; border:none; background:transparent;">
          <div class="card-header">
            <div class="card-title">Logs</div>
            <button class="sm" style="position:absolute; right:0;"
              onclick="document.getElementById('terminal-output').innerHTML=''">Clear</button>
          </div>
          <div id="terminal-output" class="terminal">
            <div class="log-info">> Ready.</div>
          </div>
        </div>
      </div>

    </div>
  </div>

</body>

</html>